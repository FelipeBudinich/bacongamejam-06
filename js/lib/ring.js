(function(){"use strict";function t(e){function n(){}var t={};t.Object=n;e.extend(t.Object,{__mro__:[t.Object],__properties__:{init:function(){}},prototype:{},__class_id__:1,parents:[],__class_index__:{1:t.Object},isSubClass:function(e){return this.__class_index__[e.__class_id__]!==undefined}});e.extend(t.Object.prototype,{$class:t.Object,init:t.Object.__properties__.init});var r=3;var i=/xyz/.test(function(){xyz()})?/\$super\b/:/.*/;t.create=function(){var n=e.toArray(arguments);n.reverse();var o=n[0];var u=n.length>=2?n[1]:[];if(u.length===0)u=[t.Object];var a=r++;var f=e.pluck(u,"__mro__");f=f.concat([u]);var l=[{__properties__:o}].concat(s(f));var c={};var h={};e.each(l,function(t){e.each(t.__properties__,function(e,t){h[t]=true})});var p=function(t,n){if(t.length===0)return undefined;var r=t[0];if(r.__properties__[n]===undefined)return p(e.rest(t),n);var s=r.__properties__[n];if(typeof s!=="function"||!i.test(s))return s;var o=p(e.rest(t),n);if(typeof o!=="function")return s;return function(e){return function(){var t=this.$super;this.$super=e;var n=s.apply(this,arguments);this.$super=t;return n}}(o)};e.each(h,function(e,t){c[t]=p(l,t)});var d=function(){this.$super=null;this.init.apply(this,arguments)};l[0]=d;d.__mro__=l;d.parents=u;d.__properties__=o;d.prototype=c;c.$class=d;d.__class_id__=a;d.__class_index__={};e.each(d.__mro__,function(e){d.__class_index__[e.__class_id__]=e});d.isSubClass=t.Object.isSubClass;if(d.prototype.$classInit){d.__class_init__=d.prototype.$classInit;delete d.prototype.$classInit}e.each(e.chain(d.__mro__).clone().reverse().value(),function(e){if(e.__class_init__){var t=e.__class_init__(d.prototype);if(t!==undefined)d.prototype=t}});return d};var s=function(n){var r=[];var i=e.clone(n);while(true){var s=false;for(var o=0;o<i.length;o++){if(i[o].length===0)continue;var u=i[o][0];var a=e.find(i,function(t){return e.contains(e.rest(t),u)});if(!a){s=true;r.push(u);i=e.map(i,function(t){if(e.head(t)===u)return e.rest(t);else return t});break}}if(s)continue;if(e.all(i,function(e){return e.length===0}))return r;throw new t.ValueError("Cannot create a consistent method resolution order (MRO)")}};t.instance=function(e,t){if(typeof e==="object"&&e.$class&&typeof t==="function"&&typeof t.__class_id__==="number"){return e.$class.isSubClass(t)}if(typeof t==="string")return typeof e===t;return e instanceof t};t.Error=t.create("RingError",[],{name:"ring.Error",defaultMessage:"",init:function(e){this.message=e||this.defaultMessage},$classInit:function(t){var n=new Error;e.extend(n,t);return n}});t.ValueError=t.create([t.Error],{name:"ring.ValueError"});return t}if(typeof exports!=="undefined"){var e=require("underscore");e.extend(exports,t(e))}else if(typeof define!=="undefined"){define(["underscore"],t)}else{window.ring=t(_)}})()